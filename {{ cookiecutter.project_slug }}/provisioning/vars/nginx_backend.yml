---
{% raw %}
nginx_http_template_enable: true

nginx_http_template:
  backend:
    port: 80
    server_name: localhost
    reverse_proxy:
      locations:
        backend:
          location: /
          proxy_pass: http://backend_servers
          proxy_set_header:
            header_host:
              name: Host
              value: $host
    web_server:
      locations:
        backend_static:
          location: /static/
          html_file_location: "{{ backend_app_static_dir }}"
          html_file_name: "index.html"
          autoindex: false
      http_demo_conf: false
    upstreams:
      upstream_1:
        name: backend_servers
        lb_method: least_conn
        zone_name: backend
        zone_size: 64k
        sticky_cookie: false
        servers:
          backend_server_1:
            address: localhost
            port: 8080
{% endraw %}